ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/eltex-pg1-v17/.ssh/id_rsa): Your identification has been saved in /home/eltex-pg1-v17/.ssh/id_rsa
Your public key has been saved in /home/eltex-pg1-v17/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:+q+mpOeuXgoD81KWXah6XRZTx+ZSJFN2gsUbe+oHWK0 eltex-pg1-v17@eltex-2025-autumn
The key's randomart image is:
+---[RSA 3072]----+
|        +BB .    |
|     . ..=*o     |
|    . +  + =     |
|   + . o. = o    |
|o = . o S+ +     |
| B . o .. E      |
|o = . +  . .     |
| o o =... . .    |
|   .==+ooo..     |
+----[SHA256]-----+
ssh-copy-id -i /home/eltex-pg1-v17/.ssh/id_rsa.pub root@172.16.9.191
sh-copy-id -i /home/eltex-pg1-v17/.ssh/id_rsa.pub root@172.16.9.191
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/eltex-pg1-v17/.ssh/id_rsa.pub"
The authenticity of host '172.16.9.191 (172.16.9.191)' can't be established.
ED25519 key fingerprint is SHA256:YNVzj+RtetZfXv5XUn/CUjeEcaMD4eg3jy8EuGGIS+o.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.16.9.191's password: 

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'root@172.16.9.191'"
and check to make sure that only the key(s) you wanted were added.
ssh root@172.16.9.191
scp practice2_eltex-pg1-v17_part1.log root@172.16.9.191:~
cat ./.ssh/authorized_keys 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCOQM6H9vKn376fCByxWffcPBk13L5rieuLbYcQ6dzXmniKMfiBdULucbqoWS3qdPiucB8Mc2Ff9KigBSsmKXC8O6vL3TqbPM1nJMeKz3cpquJSiAI7pecnjSNe7IpqEEH/KJ1BG5fzbcBXBTPzuanVPsCM9mYyYAtXPKpalsptweL4ob1E0xol1hiPrJJKRL/Yg27L0NgphnJoQjKiB58+NGehLE/PCtlPnNhDXxXXMXuBXWoZmblTAOC3/rSCQ+aegKdl/dXmTqtWxLdUi8cnV2ADBZ7azw99rU8Nt/plYLM2YaloRrh1j/YDH1WNHEIMoDHYzKc8rjlntH/m72EtflbHR7K1jhe/izfuUiGimxp82LPoM6I2pmqedazeUdTL+kUEL5g9ipphZQvH3C4FOKRy3YlExMhu02Q28rqY2wev1Zf1u777Nj0/mjDF1Wx9uVnbOGmVcKi2VT2xUFyBwnaUo9GwMI77BqcIFz8mz//eiOHexbbeJPomcMCOA8c= eltex-pg1-v17@eltex-2025-autumn
cat ./.ssh/id_rsa.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCOQM6H9vKn376fCByxWffcPBk13L5rieuLbYcQ6dzXmniKMfiBdULucbqoWS3qdPiucB8Mc2Ff9KigBSsmKXC8O6vL3TqbPM1nJMeKz3cpquJSiAI7pecnjSNe7IpqEEH/KJ1BG5fzbcBXBTPzuanVPsCM9mYyYAtXPKpalsptweL4ob1E0xol1hiPrJJKRL/Yg27L0NgphnJoQjKiB58+NGehLE/PCtlPnNhDXxXXMXuBXWoZmblTAOC3/rSCQ+aegKdl/dXmTqtWxLdUi8cnV2ADBZ7azw99rU8Nt/plYLM2YaloRrh1j/YDH1WNHEIMoDHYzKc8rjlntH/m72EtflbHR7K1jhe/izfuUiGimxp82LPoM6I2pmqedazeUdTL+kUEL5g9ipphZQvH3C4FOKRy3YlExMhu02Q28rqY2wev1Zf1u777Nj0/mjDF1Wx9uVnbOGmVcKi2VT2xUFyBwnaUo9GwMI77BqcIFz8mz//eiOHexbbeJPomcMCOA8c= eltex-pg1-v17@eltex-2025-autumn
ls -ls ~/.ssh/id_rsa.pub 
4 -rw-r--r-- 1 eltex-pg1-v17 eltex-pg1-v17 585 окт 15 19:18 /home/eltex-pg1-v17/.ssh/id_rsa.pub
ls -la ~/.ssh/authorized_keys 
-rw------- 1 root root 585 Oct 15 12:23 /root/.ssh/authorized_keys
root@eltex-practice2-pg1-v17:~# sudo useradd -m -s /bin/bash user1
root@eltex-practice2-pg1-v17:~# passwd user1
New password: 
Retype new password: 
passwd: password updated successfully
root@eltex-practice2-pg1-v17:~# id user1
uid=1001(user1) gid=1001(user1) groups=1001(user1)
root@eltex-practice2-pg1-v17:~# adduser user2
info: Adding user `user2' ...
info: Selecting UID/GID from range 1000 to 59999 ...
info: Adding new group `user2' (1002) ...
info: Adding new user `user2' (1002) with group `user2 (1002)' ...
info: Creating home directory `/home/user2' ...
info: Copying files from `/etc/skel' ...
New password: 
Retype new password: 
passwd: password updated successfully
Changing the user information for user2
Enter the new value, or press ENTER for the default
	Full Name []: Artem
	Room Number []: 223
	Work Phone []: 3
	Home Phone []: 
	Other []: 
Is the information correct? [Y/n] Y
info: Adding new user `user2' to supplemental / extra groups `users' ...
info: Adding user `user2' to group `users' ...
root@eltex-practice2-pg1-v17:~# adduser user3
info: Adding user `user3' ...
info: Selecting UID/GID from range 1000 to 59999 ...
info: Adding new group `user3' (1003) ...
info: Adding new user `user3' (1003) with group `user3 (1003)' ...
info: Creating home directory `/home/user3' ...
info: Copying files from `/etc/skel' ...
New password: 
Retype new password: 
passwd: password updated successfully
Changing the user information for user3
Enter the new value, or press ENTER for the default
	Full Name []: Parfenov
	Room Number []: 223
	Work Phone []: 
	Home Phone []: 
	Other []: 
Is the information correct? [Y/n] Y
info: Adding new user `user3' to supplemental / extra groups `users' ...
info: Adding user `user3' to group `users' ...
sudo usermod -s /usr/sbin/nologin user3
root@eltex-practice2-pg1-v17:~# su user3 
This account is currently not available.
root@eltex-practice2-pg1-v17:~# su -s /bin/bash user3
user3@eltex-practice2-pg1-v17:/root$ ls
ls: cannot open directory '.': Permission denied
user3@eltex-practice2-pg1-v17:/root$ logout
bash: logout: not login shell: use `exit'
sudo groupadd myusergroup
root@eltex-practice2-pg1-v17:~# sudo usermod -a -G myusergroup user1 
root@eltex-practice2-pg1-v17:~# sudo usermod -a -G myusergroup user2
root@eltex-practice2-pg1-v17:~# sudo usermod -a -G myusergroup user3
root@eltex-practice2-pg1-v17:~# getent group myusergroup
myusergroup:x:1004:user1,user2,user3
root@eltex-practice2-pg1-v17:~# sudo mkdir /opt/share
root@eltex-practice2-pg1-v17:~# ls /opt/
share
root@eltex-practice2-pg1-v17:~# sudo chgrp myusergroup  /opt/share
root@eltex-practice2-pg1-v17:~# sudo chmod 2770 /opt/share
root@eltex-practice2-pg1-v17:~# ls -la /opt/share/
total 8
drwxrws--- 2 root myusergroup 4096 Oct 17 03:48 .
drwxr-xr-x 3 root root        4096 Oct 17 03:48 ..
root@eltex-practice2-pg1-v17:~# su - user1 -c "umask
> 
> "
0002
root@eltex-practice2-pg1-v17:~# su - user1 -c "echo 'umask 0026' >> ~/.profile"
root@eltex-practice2-pg1-v17:~# su - user1 -c "umask"                          
0026
root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ touch /opt/share/file1.txt
user1@eltex-practice2-pg1-v17:/root$ su user2
Password: 
user2@eltex-practice2-pg1-v17:/root$ touch /opt/share/file2.txt 
user2@eltex-practice2-pg1-v17:/root$ su user3 
Password: 
This account is currently not available.
user2@eltex-practice2-pg1-v17:/root$ exit
exit
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user3 -s /bin/bas
base32    base64    basename  basenc    bash      bashbug   
root@eltex-practice2-pg1-v17:~# su user3 -s /bin/bash
user3@eltex-practice2-pg1-v17:/root$ touch /opt/share/file3.txt
user3@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# ls /opt/share/
file1.txt  file2.txt  file3.txt
root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ rm /opt/share/file2.txt 
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user2
user2@eltex-practice2-pg1-v17:/root$ rm /opt/share/file3.txt 
user2@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user3
This account is currently not available.
root@eltex-practice2-pg1-v17:~# su user3 -s /bin/bash
user3@eltex-practice2-pg1-v17:/root$ rm /opt/share/file1.txt 
user3@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# ls /opt/share/
root@eltex-practice2-pg1-v17:~# 

chmod +t /opt/share/
root@eltex-practice2-pg1-v17:~# ls -ld /opt/share/
drwxrws--T 2 root myusergroup 4096 Oct 17 08:21 /opt/share/

root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ touch /opt/share/file1.txt
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user2
user2@eltex-practice2-pg1-v17:/root$ touch /opt/share/file2.txt
user2@eltex-practice2-pg1-v17:/root$ ls /opt/share/
file1.txt  file2.txt
user2@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su -s /bin/bash user3
user3@eltex-practice2-pg1-v17:/root$ touch /opt/share/file3.txt

root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ rm /opt/share/file2.txt
rm: cannot remove '/opt/share/file2.txt': Operation not permitted
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user2
user2@eltex-practice2-pg1-v17:/root$ rm /opt/share/file3.txt 
rm: cannot remove '/opt/share/file3.txt': Operation not permitted
user2@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user3
This account is currently not available.
root@eltex-practice2-pg1-v17:~# su -s /bin/bash user3
user3@eltex-practice2-pg1-v17:/root$ rm /opt/share/file
file1.txt  file2.txt  file3.txt  
user3@eltex-practice2-pg1-v17:/root$ rm /opt/share/file1
rm: cannot remove '/opt/share/file1': No such file or directory
user3@eltex-practice2-pg1-v17:/root$ rm /opt/share/file1.txt 
rm: cannot remove '/opt/share/file1.txt': Operation not permitted

root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ rm /opt/share/file1.txt 
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su user2
user2@eltex-practice2-pg1-v17:/root$ rm /opt/share/file2.txt 
user2@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# su -s /bin/bash user3
user3@eltex-practice2-pg1-v17:/root$ rm /opt/share/file3.txt 
user3@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~# ls /opt/share/
root@eltex-practice2-pg1-v17:~#

root@eltex-practice2-pg1-v17:~# visudo -f /etc/sudoers.d/dmesg-user1
root@eltex-practice2-pg1-v17:~# cat /etc/sudoers.d/dmesg-user1 
user1 ALL=(ALL) /usr/bin/dmesg
root@eltex-practice2-pg1-v17:~#
root@eltex-practice2-pg1-v17:~# sudo nano /usr/local/bin/dmesg_suid.sh
root@eltex-practice2-pg1-v17:~# cat /usr/local/bin/dmesg_suid.sh 
#!/bin/bash
/usr/bin/dmesg "$@"
root@eltex-practice2-pg1-v17:~# 

root@eltex-practice2-pg1-v17:~# su user1
user1@eltex-practice2-pg1-v17:/root$ dmesg | head -3
[    0.000000] Linux version 6.8.0-55-generic (buildd@lcy02-amd64-095) (x86_64-linux-gnu-gcc-13 (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0, GNU ld (GNU Binutils for Ubuntu) 2.42) #57-Ubuntu SMP PREEMPT_DYNAMIC Wed Feb 12 23:42:21 UTC 2025 (Ubuntu 6.8.0-55.57-generic 6.8.12)
[    0.000000] Command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
[    0.000000] KERNEL supported cpus:
user1@eltex-practice2-pg1-v17:/root$ exit
exit
root@eltex-practice2-pg1-v17:~#
root@eltex-practice2-pg1-v17:~# su user2
user2@eltex-practice2-pg1-v17:/root$ dmesg | tail -5
[89350.542774] audit: type=1400 audit(1760604068.020:280): apparmor="DENIED" operation="mknod" class="file" profile="ubuntu_pro_apt_news" name="/usr/lib/python3/dist-packages/uaclient/api/u/__pycache__/__init__.cpython-312.pyc.136063705943600" pid=38092 comm="python3" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
[89350.666091] audit: type=1400 audit(1760604068.144:281): apparmor="DENIED" operation="mknod" class="file" profile="ubuntu_pro_apt_news" name="/usr/lib/python3/dist-packages/uaclient/api/u/pro/__pycache__/__init__.cpython-312.pyc.136063705943472" pid=38092 comm="python3" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
[89350.890211] audit: type=1400 audit(1760604068.368:282): apparmor="DENIED" operation="mknod" class="file" profile="ubuntu_pro_apt_news" name="/usr/lib/python3/dist-packages/uaclient/api/u/pro/status/__pycache__/__init__.cpython-312.pyc.136063705760800" pid=38092 comm="python3" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
[89351.265227] audit: type=1400 audit(1760604068.743:283): apparmor="DENIED" operation="mknod" class="file" profile="ubuntu_pro_apt_news" name="/usr/lib/python3/dist-packages/uaclient/api/u/pro/status/is_attached/__pycache__/__init__.cpython-312.pyc.136063705784176" pid=38092 comm="python3" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
[89351.292421] audit: type=1400 audit(1760604068.770:284): apparmor="DENIED" operation="mknod" class="file" profile="ubuntu_pro_esm_cache" name="/usr/lib/python3/dist-packages/uaclient/__pycache__/actions.cpython-312.pyc.130451525650096" pid=38093 comm="python3" requested_mask="c" denied_mask="c" fsuid=0 ouid=0
user2@eltex-practice2-pg1-v17:/root$ 

root@eltex-practice2-pg1-v17:~# sudo chage -M 10 user1
root@eltex-practice2-pg1-v17:~# sudo chage -M 10 user2
root@eltex-practice2-pg1-v17:~# sudo chage -M 10 user3
root@eltex-practice2-pg1-v17:~# sudo chage -l user3
Last password change					: Oct 16, 2025
Password expires					: Oct 26, 2025
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 10
Number of days of warning before password expires	: 7
root@eltex-practice2-pg1-v17:~# sudo chage -l user2
Last password change					: Oct 16, 2025
Password expires					: Oct 26, 2025
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 10
Number of days of warning before password expires	: 7
root@eltex-practice2-pg1-v17:~# sudo chage -l user1
Last password change					: Oct 16, 2025
Password expires					: Oct 26, 2025
Password inactive					: never
Account expires						: never
Minimum number of days between password change		: 0
Maximum number of days between password change		: 10
Number of days of warning before password expires	: 7
root@eltex-practice2-pg1-v17:~# 
root@eltex-practice2-pg1-v17:~# nano /etc/motd
root@eltex-practice2-pg1-v17:~# сфе /etc/motd
сфе: command not found
root@eltex-practice2-pg1-v17:~# cat /etc/motd 
Парфенов Артём
root@eltex-practice2-pg1-v17:~# 
root@eltex-practice2-pg1-v17:~# rsync -a /etc/ /root/etc_backup/
root@eltex-practice2-pg1-v17:~# ls
etc_backup  practice2_eltex-pg1-v17_part1.log
root@eltex-practice2-pg1-v17:~# tar -czf etc_backup.tar.gz etc_backup/
root@eltex-practice2-pg1-v17:~# ls
etc_backup  etc_backup.tar.gz  practice2_eltex-pg1-v17_part1.log
root@eltex-practice2-pg1-v17:~# tar -cjf etc_backup.tar.bz2 etc_backup/
root@eltex-practice2-pg1-v17:~# 7z a -t7z etc_backup.7z etc_backup/

root@eltex-practice2-pg1-v17:~# ls
etc_backup     etc_backup.tar.bz2    etc_backup.7z 
etc_backup.tar.gz   practice2_eltex-pg1-v17_part1.log
ls -lh /root/etc_backup.*
-rw-r--r-- 1 root root 4.5M Oct 18 06:23 /root/etc_backup.7z
-rw-r--r-- 1 root root 550K Oct 18 06:23 /root/etc_backup.tar.bz2
-rw-r--r-- 1 root root 583K Oct 18 06:23 /root/etc_backup.tar.gz
root@eltex-practice2-pg1-v17:~# echo "$(date)" >> /etc/motd
root@eltex-practice2-pg1-v17:~# cat /etc/motd 
Парфенов Артём
Sat Oct 18 07:03:11 UTC 2025
root@eltex-practice2-pg1-v17:~# rsync -a /etc/ /root/etc_backup/
root@eltex-practice2-pg1-v17:~# 
root@eltex-practice2-pg1-v17:~# tar -czf etc_backup.tar.gz etc_backup/ etc_backup/motd
root@eltex-practice2-pg1-v17:~# tar -tjf /root/etc_backup.tar.bz2 | sort > /tmp/archive_files.txt
root@eltex-practice2-pg1-v17:~# find /root/etc_backup -type f | sed 's|/root/etc_backup/||' | sort > /tmp/directory_files.txt
root@eltex-practice2-pg1-v17:~# diff -rq /tmp/archive_files.txt /tmp/directory_files.txt
Files /tmp/archive_files.txt and /tmp/directory_files.txt differ

root@eltex-practice2-pg1-v17:~# diff /root/etc_backup_gzip/etc_backup/motd /root/etc_backup_7zip/etc_backup/motd 
2d1
< Sat Oct 18 07:03:11 UTC 2025
root@eltex-practice2-pg1-v17:~# 
